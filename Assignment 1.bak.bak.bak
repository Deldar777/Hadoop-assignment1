from mrjob.job import MRJob
from mrjob.step import MRStep

class CountRatins (MRJob):
    def steps(self):
        return [
             MRStep(mapper=self.mapper_get_movieID,
                    reducer=self.reducer_count_ratings,
                    ),
             MRStep(reducer=self.rducer_sort_values)
        ]
    def mapper_get_movieID(self , _, line):
        (userID, movieID, rating, timestamp) = line.split('\t')
         yield movieID, 1

    def reducer_count_ratings (self, key, values):
        yield int (key), sum(values)

    def reducer_sort_values (self, movieID, number_of_rating):
        yield movieID , soretd(number_of_rating)

if__name__== '__main__':
   CountRatings.run()
                          